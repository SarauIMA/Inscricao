<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jura:wght@300..700&family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
  <link rel="stylesheet" href="stymus.css">
  <title>Músicas</title>
</head>
<body>
<div class="cabecalho">
    <h1>Músicas</h1>
    <a href="index.html" class="voltar">&#11013 Voltar</a>
</div>
<div class="info">
    <p>Nossa equipe selecionou algumas musicas que se encaixam no tema classicismo para aa apresentações.</p>
    <p class="alert">*Clique em uma música para se inscrever com ela</p>
</div>
<div class="line"></div>


  <div id="musicas">
      <ul id="listaMusicas">
        <li data-musica="Anos Luz"><a href="inscricao.html?Nome_Musica=Anos Luz">Anos Luz (Matue)</a></li>
        <li data-musica="Vampiro"><a href="inscricao.html?Nome_Musica=Vampiro">Vampiro (Matue)</a></li>
        <li data-musica="Lama no Copo"><a href="inscricao.html?Nome_Musica=Lama no Copo">Lama no Copo (Matue)</a></li>
        <li data-musica="1993"><a href="inscricao.html?Nome_Musica=1993">1993 (Matue)</a></li>
        <li data-musica="333"><a href="inscricao.html?Nome_Musica=333">333 (Matue)</a></li>
        <li data-musica="O Som"><a href="inscricao.html?Nome_Musica=O Som">O Som (Matue)</a></li>
        <li data-musica="Maquina do tempo"><a href="inscricao.html?Nome_Musica=Maquina do tempo">Maquina do tempo (Matue)</a></li>
        <li data-musica="Gorila Roxo"><a href="inscricao.html?Nome_Musica=Gorila Roxo">Gorila Roxo (Matue)</a></li>
        <li data-musica="Coneccoes de Mafia"><a href="inscricao.html?Nome_Musica=Coneccoes de Mafia">Coneccoes de Mafia (Matue)</a></li>
        <li data-musica="Imagina esse cenario"><a href="inscricao.html?Nome_Musica=Imagina esse cenario">Imagina esse cenario (Matue)</a></li>
      </ul>
  </div>

  <div class="rodape">
    <p>Sarau 2° serie</p>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
    import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

    // Config do Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCuEpu6-I7c9PGSe-OOsNGcphrswVoNqjk",
      authDomain: "sarau-bac13.firebaseapp.com",
      projectId: "sarau-bac13",
    };
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    async function bloquearMusicas() {
        const querySnapshot = await getDocs(collection(db, "inscricoes"));
        const usadas = querySnapshot.docs.map(doc => doc.data().musica);

        const links = document.querySelectorAll("#musicas ul li a");

        links.forEach(link => {
            // pega o valor da música do href
            const urlParams = new URLSearchParams(link.href.split("?")[1]);
            const musica = urlParams.get("Nome_Musica");

            if (usadas.includes(musica)) {
                link.removeAttribute("href"); // não clicável
                link.classList.add("usada");  // classe para estilizar
            }
        });
    }

    bloquearMusicas();
    </script>
</body>
</html>
